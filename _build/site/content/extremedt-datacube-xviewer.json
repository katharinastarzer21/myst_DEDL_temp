{"version":2,"kind":"Notebook","sha256":"e0e396d64f7c1646fbc1d34296ead0083026935dd921f20ed381dca61d4bb699","slug":"extremedt-datacube-xviewer","location":"/STACK/ExtremeDT-DataCube-xViewer.ipynb","dependencies":[],"frontmatter":{"title":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"xcube_env","language":"python"},"numbering":{"title":{"offset":2}},"thumbnail":"/13671a697054e05ccbcc105d371ab38b.png","exports":[{"format":"ipynb","filename":"ExtremeDT-DataCube-xViewer.ipynb","url":"/ExtremeDT-DataCube-x-12542f08dd483a0546603f360a7e8811.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/995a6422bb495aec567bfe2c736e59ed.png","alt":"image.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UyIwxksvx2","urlSource":"data:image/png;base64,iVBORw0KGg...5ErkJggg=="}],"key":"zmYFMIDs7u"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e2t6CexGJW"}],"key":"fxdLAzKRdM"},{"type":"text","value":" EUMETSAT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hD6e5smfDf"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"afNLErRjXC"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Copyright:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p8vdgzvNLr"}],"key":"MmMTG0ap1c"},{"type":"text","value":" 2024 EUMETSAT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oVL5IWOQxx"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w8kYCYmRmi"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Licence:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ILjMMp0RJH"}],"key":"lxpruLpckL"},{"type":"text","value":" MIT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OySQNnRdHU"}],"key":"dW56RGDjTP"}],"key":"ZicWov42BW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GajfKDvBXm"}],"identifier":"create-a-dashboard-based-on-data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","label":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","html_id":"create-a-dashboard-based-on-data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","implicit":true,"key":"SuTGMBYtNH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"DISCLAIMER","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bg04368p5l"}],"key":"rXUmmZt3Ff"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tf0wh9shtO"},{"type":"text","value":"In order to deal with the code provided within this notebook, it is required to run it on user environment (local one or virtual machine).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z4VZQI9V5S"}],"key":"k6M8osd0XC"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This notebook covers:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yP6r1A8vQ1"}],"key":"x69je0ILhn"}],"key":"X7tNuHth4X"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"find available data cubes and their urls","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ajg9J2ApaP"}],"key":"fsS5JVgxTb"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"filter data area of interest","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"oge6Dz8UtW"}],"key":"iSU7CTAsAm"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"create interactive dashboard using xcube - xviewer","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HDfObaK5YV"}],"key":"XBequ0rPn2"}],"key":"aFzcegWLws"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Presequites","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MBXwcCuZvO"}],"key":"qeiz93GmNA"}],"key":"augVZXPDPW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Xcube\nInstall xcube and create a new environment ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"tW64mKDYN0"},{"type":"inlineCode","value":"mamba create --name xcube --channel conda-forge xcube","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fCwFnBHUOT"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"KqkFqqFxPq"},{"type":"text","value":"OR","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qPrVM61Y9m"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"YYrWHv5a8d"},{"type":"text","value":"Install xcube in the current environment  ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"arBK3fEgyd"},{"type":"inlineCode","value":"mamba install --channel conda-forge xcube","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ytgqooMR98"}],"key":"AK8ESxhdJs"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Xarray","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"tUJMdmEp1R"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"B8Dbq5FOXO"},{"type":"text","value":"pip ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"tv8o1UIU6z"},{"type":"inlineCode","value":"pip install xarray","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Sejh3Uuztm"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Q2Xw0wWNF7"},{"type":"text","value":"OR","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ArwXCDUXgE"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"QOYLjEF75D"},{"type":"text","value":"conda  ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"o8FgRWRirQ"},{"type":"inlineCode","value":"conda install -c conda-forge xarray dask netCDF4 bottleneck","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"C0uDKfIheY"}],"key":"WD8VlM9sEl"}],"key":"He6e3MZHDK"}],"key":"IvgycBlMbb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepre your environment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GQogq5O5iR"}],"identifier":"prepre-your-environment","label":"Prepre your environment","html_id":"prepre-your-environment","implicit":true,"key":"Sf7L5fEsoU"}],"key":"gz4QNzx2SX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from xcube.webapi.viewer import Viewer\nimport xarray as xr\nimport requests","key":"snRA287JAP"},{"type":"output","id":"GHBwOiwOpoPWJvz4_Vp2w","data":[],"key":"wcuOtx7buU"}],"key":"COSUnXsuKQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Connect with Extreme DT data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XjCeJao3EO"}],"identifier":"connect-with-extreme-dt-data-cube","label":"Connect with Extreme DT data cube","html_id":"connect-with-extreme-dt-data-cube","implicit":true,"key":"wqqOT93fLc"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The data cube provides data:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BeLRXk8J6h"}],"key":"JF6VKP338F"}],"key":"le1BsfR8gQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Four variables","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fImBOSakep"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"2t - Air temperature at 2 meteres above grond [K]","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"pknwi7IKEL"}],"key":"wgrCPswIPf"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2d - Dew point temperature at 2 meteres above grond [K]","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zwqZsPo48A"}],"key":"C12LUv4dbM"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"sp - Surface pressure [Pa]","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eBpu5yQJxb"}],"key":"Yugtw4loaL"}],"key":"vWczLXm8b8"}],"key":"lgY6kVQRDL"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Forecast 2024.04.04-13 + 96 hours for each date","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GtbKSdz9L4"}],"key":"EpJlPy47eK"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Hourly step","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"HrrRnECLc2"}],"key":"D8HxIAiIgX"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"World","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ah6oIfVQPu"}],"key":"jUVg6dWggm"}],"key":"AybtqTwKN1"}],"key":"k4AR6RXF41"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select proper data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HjAx0H8jHZ"}],"identifier":"select-proper-data-cube","label":"Select proper data cube","html_id":"select-proper-data-cube","implicit":true,"key":"znZ5pSuvv7"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Data cubes on s3 bucket are stored under URL ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FG8Eg3trMK"},{"type":"link","url":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​s3​.central​.data​.destination​-earth​.eu​/swift​/v1​/dedl​_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KbBq01KWpe"}],"urlSource":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","key":"oI58BLkqJr"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fe9t6ByPpd"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"UFYEyz0eYl"},{"type":"text","value":"Data cubes are stored in two directories:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KDNY7SwQre"}],"key":"XzkNIQzR1E"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"ExtremeDT - the newest one","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EkMDRzCXRW"}],"key":"QofBPyRQYS"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"archive - from preicus days","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zEcZPjWKqO"}],"key":"e3v25iDD3l"}],"key":"V8GryKsEIJ"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"File nameing convention:","key":"F5WMHOysUY"}],"key":"xhIpCWBq2W"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cE7p38qPjP"},{"type":"text","value":"dt_extreme_YYYYMMDD.zarr/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tEdtNTvWlG"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"sVtH4mo4Qk"},{"type":"text","value":"YYYYMMDD - is the date when forecast starts (step 0)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jGHt71MO0z"}],"key":"CRCBAUqOvO"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"Results","key":"EdA0ijUnv2"}],"key":"WEsNoYKhpS"},{"type":"break","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nT1jx9FTzC"},{"type":"text","value":"After exectution of code below, the list of urls linked to available cubes will be printed.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"sGv9FDwK2C"}],"key":"EMFYY10NVw"}],"key":"yoXGtgA8bJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# URL to s3 where  ExtremeDT data cubes are stored\ndatacube_url = 'https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube'\nresponse = requests.get(datacube_url)\n\nif response.status_code == 200:\n    lines = response.text.splitlines()\n    zarr_items = [line for line in lines if line.endswith('.zarr') or line.endswith('.zarr/')]\n    if zarr_items:\n        for item in zarr_items:\n            print(item)\n            new_url = f\"{datacube_url}/{item}\"\n            print(\"New URL:\", new_url)\n    else:\n        print(\"No .zarr files or directories found.\")\nelse:\n    print(\"Failed to fetch contents. Status code:\", response.status_code)","key":"pMTkjezUXm"},{"type":"output","id":"QAdH9weczddYOr41DVrpL","data":[{"name":"stdout","output_type":"stream","text":"ExtremeDT/dt_extreme_20240404.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240404.zarr/\nExtremeDT/dt_extreme_20240405.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240405.zarr/\nExtremeDT/dt_extreme_20240406.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240406.zarr/\nExtremeDT/dt_extreme_20240407.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240407.zarr/\nExtremeDT/dt_extreme_20240408.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240408.zarr/\nExtremeDT/dt_extreme_20240410.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240410.zarr/\nExtremeDT/dt_extreme_20240411.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240411.zarr/\nExtremeDT/dt_extreme_20240412.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240412.zarr/\nExtremeDT/dt_extreme_20240413.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240413.zarr/\narchive/dt_extreme_20240409.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/archive/dt_extreme_20240409.zarr/\n"}],"key":"h9vyYhpL3t"}],"key":"QdABLD9M5I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"url = 'https://s3.waw3-1.cloudferro.com/swift/v1/s5p_l3/ExtremeDT/dt_extreme_20240412.zarr/'","key":"GbWfE4DTsH"},{"type":"output","id":"Hm1l_K4JVvlIhsi54K6oX","data":[],"key":"rJ7p43dbtL"}],"key":"Gz9Bq1qNGs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Area of interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SpwRQ3V8cC"}],"identifier":"area-of-interest","label":"Area of interest","html_id":"area-of-interest","implicit":true,"key":"eRHJSmbW3p"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Upload data for selected area and verify what variables are provided. In this case uplaod data for Kenya. List of available variables should be returend.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"XgCzsysmIC"}],"key":"FsOI5hoBBe"}],"key":"livQgf5Znk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_bbox = [33.501,   # West\n              -4.677,   # South\n              41.899,   # East\n              5.193]    # North\n\nkenya_dt = xr.open_zarr(url).sel(lon=slice(kenya_bbox[0], \n                                            kenya_bbox[2]), \n                                lat=slice(kenya_bbox[3], \n                                            kenya_bbox[1]),\n                                                         )\n\nlist(kenya_dt.keys())","key":"QUvrLe9XUC"},{"type":"output","id":"EXz6lTxnAFtXqxO_wDHxm","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"['2d', '2t', 'sp']","content_type":"text/plain"}}}],"key":"F3CWDnn2Pc"}],"key":"gkx4F5dE6K"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepare Data for visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uIAhTvh3IA"}],"identifier":"prepare-data-for-visualization","label":"Prepare Data for visualization","html_id":"prepare-data-for-visualization","implicit":true,"key":"THSA1AsnkH"}],"key":"qCU6qfIqvV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert units","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eworXcjG72"}],"identifier":"convert-units","label":"Convert units","html_id":"convert-units","implicit":true,"key":"wu99NKRXTn"}],"key":"RotFmQJoci"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_dt['2t'] -= 273.15    # Conversion to Celcius degrees\nkenya_dt['2d'] -= 273.15    # Conversion to Celcius degrees\nkenya_dt['sp'] /= 100       # Conversion to hectoPascals","key":"RPII8AMPw3"},{"type":"output","id":"CJtX_bUn1IUeYd-pvKzMv","data":[],"key":"e4TFRAoFYD"}],"key":"u66IztduqH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_dt['2t'].attrs['units'] = '°C'\nkenya_dt['2d'].attrs['units'] = '°C'\nkenya_dt['sp'].attrs['units'] = 'hPa'","key":"j32RGAoiyp"},{"type":"output","id":"FmQSbHndN_VALyY0u-UrB","data":[],"key":"wyS5UhjlDg"}],"key":"TpDziEe9Jp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define style of visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dgeqPoUMS6"}],"identifier":"define-style-of-visualization","label":"Define style of visualization","html_id":"define-style-of-visualization","implicit":true,"key":"Ds4IUYaxsZ"}],"key":"tBOdeQbAZF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Error message starting with:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aHmdwbzfz6"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vdYdwHiZqv"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 2.14ms","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eCv88UPS5L"}],"key":"F230gPWK64"}],"key":"Up0Fnqc8hA"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Oea0eTz6qk"},{"type":"text","value":"could occur.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dR6rLIHfr7"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tlfpg6tp98"},{"type":"text","value":"It is normal and does not affect on proper functioning of xviewer.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MrUidYr6lX"}],"key":"NZC4PepAI0"}],"key":"x5yWKEFqe8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer = Viewer(server_config={\n    \"Styles\": [\n        {\n            \"Identifier\": \"dt_legend\",          # Style's name\n            \"ColorMappings\": {\n                \"2t\": {                         # Variable's name\n                    \"ValueRange\": [10, 30],     # Variable's values range\n                    \"ColorBar\": \"coolwarm\"      # colorbar\n                },\n                \"2d\": {                         # Variable's name\n                    \"ValueRange\": [0, 20],\n                    \"ColorBar\": \"coolwarm\",\n                },\n                'sp': {                         # Variable's name\n                    \"ValueRange\": [0, 1000],    # Variable's values range\n                    \"ColorBar\": \"viridis\"       # colorbar\n                },\n            }\n        },\n    ]\n})","key":"F7SYePOOnl"},{"type":"output","id":"1vWHWUwCFP08gG0hS4hvV","data":[{"name":"stderr","output_type":"stream","text":"404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 2.14ms\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/schema.py:464: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  dim_name: cube_chunks.get(dim_name, cube.dims[dim_name])\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/timecoord.py:248: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.\n  return getattr(timestamp, round_fn)(freq).isoformat() + 'Z'\n404 GET /favicon.ico (127.0.0.1) 0.52ms\n404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 1.51ms\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/timecoord.py:248: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.\n  return getattr(timestamp, round_fn)(freq).isoformat() + 'Z'\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/65/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/65/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/62/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/62/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception POST /timeseries/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d?aggMethods=mean%2Cstd&startDate=2024-04-12T00%3A00%3A00Z&endDate=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='POST', uri='/timeseries/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d?aggMethods=mean%2Cstd&startDate=2024-04-12T00%3A00%3A00Z&endDate=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 357, in post\n    await self._call_method('post', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/timeseries/routes.py\", line 122, in post\n    await self.response.finish(dict(result=result))\ntornado.iostream.StreamClosedError: Stream is closed\n"}],"key":"fO1oQWyCNS"}],"key":"QyNSxhqTso"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Add style to the data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"td51H9E2XP"}],"identifier":"add-style-to-the-data-cube","label":"Add style to the data cube","html_id":"add-style-to-the-data-cube","implicit":true,"key":"vfGVfrV7Te"}],"key":"K5FY6KOI2c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer.add_dataset(kenya_dt, \n                   style=\"dt_legend\")","key":"efai9YcDTN"},{"type":"output","id":"GZmwFTy118WOl7Lg7ylST","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"'ba3aaa64-1bdf-425d-8458-98b819c0e042'","content_type":"text/plain"}}}],"key":"NFPqiUsObc"}],"key":"vXAPR1xa11"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the dashboard","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zXcm9Zlqsy"}],"identifier":"run-the-dashboard","label":"Run the dashboard","html_id":"run-the-dashboard","implicit":true,"key":"zR88mE63uu"}],"key":"Kiu5EkXc5O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer.info()       # open dashboard in separate tab in browser\n#viewer.show()      # open dashboard in current Jupyter Notebook","key":"kAyJHh8EcY"},{"type":"output","id":"syI5LZV4UbjPT5-4r-_ps","data":[{"name":"stdout","output_type":"stream","text":"Server: http://localhost:8002\nViewer: http://localhost:8002/viewer/?serverUrl=http://localhost:8002\n"}],"key":"Wnk7WpwUI2"}],"key":"hxfJz0wm47"}],"key":"N0lvQM3YXT"},"references":{"cite":{"order":[],"data":{}}}}